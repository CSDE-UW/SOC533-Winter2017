---
title: "Homework #4"
subtitle: | 
  | SOC 533: Demographic Methods 
author: |
  | Erin Carll
  | (collaborated with Christine Leibbrand)
date: '`r Sys.Date()`'
output: pdf_document
---
### 1 (Chapter 5, Question 5)  

```{r, message=FALSE, warning=FALSE, tidy=TRUE}
A5<- matrix(c(0.551,0.962,0,0.556,0,0.909,0.037,0,0),
  nrow=3,ncol=3)
colnames(A5)<-c("0-18","18-36","36-54")
rownames(A5)<-c("0-18","18-36","36-54")
A5
``` 

### 5(a) The interval of time covered by a single projection step is 18 years.  


### 5(b)   
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
B5<- matrix(c(3.9,3.3,2.8),
  nrow=3,ncol=1)
B5
C5<-A5 %*% B5
C5
D5<-C5[1,1]+C5[2,1]+C5[3,1]
D5
``` 
The expected number of women up to age 54 at the end of the first projection step is `r D5` million.  

### 5(c)   
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
E5<-sum(A5 %*% A5 %*% A5 %*% B5)
E5
``` 
The expected number of women up to age 54 at the end of three projection steps (in 2046) is `r E5` million women. 

### 5(d)  
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
GROWTH<-(E5-D5)/D5 
GROWTH
``` 
The population is expected to grow at a rate of `r GROWTH` between 1992 and 2046.  

### 2 (Chapter 5, Question 6)  
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
A<- matrix(
  c(0,0,0.152,0.466,0.629,0.607,0.521,0.331,0.125,0.022,(458/474),0,0,0,0,0,0,0,0,0,0,(452/458),0,0,0,0,0,0,0,0,0,0,(447/452),0,0,0,0,0,0,0,0,0,0,(441/447),0,0,0,0,0,0,0,0,0,0,(435/441),0,0,0,0,0,0,0,0,0,0,(426/435),0,0,0,0,0,0,0,0,0,0,(416/426),0,0,0,0,0,0,0,0,0,0,(405/416),0,0,0,0,0,0,0,0,0,0,(391/405),0),
  nrow=10,
  ncol=10
)
REALLYA<-t(A) ## I put the first matrix in reading across the rows, rather than down 
## the columns, so I am taking the transpose of A to get it right.
colnames(REALLYA)<-c("0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40-45","45-50")
rownames(REALLYA)<-c("0-5","5-10","10-15","15-20","20-25","25-30","30-35","35-40","40-45","45-50")
## The 10x10 Leslie Matrix is as follows: 
REALLYA 
B<- matrix(
  c(474,458,452,447,441,435,426,416,405,391),
  nrow=10,
  ncol=1
)
B
C<-matrix(REALLYA %*% B)
## The product of the Leslie Matrix and the vector of person-years lived is as follows: 
C 
``` 
   
### 3a  
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
A3<- matrix(c(0.8894,0.7058,0,1.3650,0,0.4200,0.2600,0,0),
  nrow=3,ncol=3)
colnames(A3)<-c("0-5","5-10","10-15")
rownames(A3)<-c("0-5","5-10","10-15")
A3
K0<-matrix(c(1,6,0), nrow=3, ncol=1)
K0
A320<-(A3 %*% A3 %*% A3 %*% A3 %*% A3 %*%A3 %*% A3 %*% A3 %*% A3 %*% A3 %*% A3 %*% A3 %*% A3 %*% A3 %*%A3 %*% A3 %*% A3 %*% A3 %*% A3 %*% A3)
F3<-(A320 %*% K0)
F3
E3<-sum(F3)
E3
RATIO1<-F3[3,1]/F3[1,1]
RATIO1
```  
After 100 years, the total horse population is expected to be 43292.86 and the ratio of 10-15 year-old horses to 0-5 year-old horses is `r RATIO1`. 

### 3b  
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
K0_1<-matrix(c(4,2,1), nrow=3, ncol=1)
K0_1
F3A<-(A320 %*% K0_1)
F3A
E3A<-sum(F3A)
E3A
RATIO2<-F3A[3,1]/F3A[1,1]
RATIO2
```  
After 100 years, the total horse population is expected to be 39682.79 and the ratio of 10-15 year-old horses to 0-5 year-old horses is `r RATIO2`. 

### 3c  
```{r, message=FALSE, warning=FALSE, tidy=TRUE}
K0_2<-matrix(c(3,3,1), nrow=3, ncol=1)
K0_2
F3C<-(A320 %*% K0_2)
F3C
E3C<-sum(F3C)
E3C
RATIO3<-F3C[3,1]/F3C[1,1]
RATIO3
```  
After 100 years, a horse population starting with 3 0-5 year-olds, 3 5-10 year-olds, and 1 10-15 year-old is expected to grow to a size of 39216.13 with a ratio of 10-15 year-old horses to 0-5 year-old horses of `r RATIO3`.

```{r, message=FALSE, warning=FALSE, tidy=TRUE}
K0_3<-matrix(c(5,0,3), nrow=3, ncol=1)
K0_3
F3D<-(A320 %*% K0_3)
F3D
E3D<-sum(F3D)
E3D
RATIO4<-F3D[3,1]/F3D[1,1]
RATIO4
```  
After 100 years, a horse population starting with 5 0-5 year-olds, 0 5-10 year-olds, and 3 10-15 year-olds is expected to grow to a size of 36247.38 with a ratio of 10-15 year-old horses to 0-5 year-old horses of `r RATIO4`.  

```{r, message=FALSE, warning=FALSE, tidy=TRUE}
K0_4<-matrix(c(1,7,1), nrow=3, ncol=1)
K0_4
F3E<-(A320 %*% K0_4)
F3E
F3D<-sum(F3E)
F3D
RATIO5<-F3E[3,1]/F3E[1,1]
RATIO5
```  
After 100 years, a horse population starting with 1 0-5 year-old, 7 5-10 year-olds, and 1 10-15 year-old is expected to grow to a size of 50518.86 with a ratio of 10-15 year-old horses to 0-5 year-old horses of `r RATIO5`.